metadata:
  id: CUSTOM_AZURE_KV_KEY_EXPIRY_REQUIRED
  name: Key Vault keys must define an expiration date
  category: ENCRYPTION
  severity: MEDIUM
scope:
  provider: azure
definition:
  and:
    - cond_type: attribute
      resource_types: [azurerm_key_vault_key]
      attribute: expiration_date
      operator: exists
