metadata:
  id: CUSTOM_AZURE_ALLOWED_RESOURCES
  name: Only allow specific Azure resource types (allowlist)
  category: GOVERNANCE
  severity: HIGH
scope:
  provider: azure
definition:
  cond_type: resource
  resource_types:
    - azurerm_resource_group
    - azurerm_virtual_network
    - azurerm_subnet
    - azurerm_storage_account
    - azurerm_storage_container
    - azurerm_key_vault
    - azurerm_key_vault_key
    - azurerm_storage_account_customer_managed_key
    - azurerm_private_endpoint
    - azurerm_role_assignment
  operator: exists
